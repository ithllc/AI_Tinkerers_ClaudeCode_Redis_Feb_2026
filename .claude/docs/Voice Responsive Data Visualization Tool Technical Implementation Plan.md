# Voice Responsive Data Visualization Tool Technical Implementation Plan

# Technical Implementation Plan

Phase 1: The "Memory" Layer (Redis)  
Goal: Setup Redis to store the session\_context.  
Schema: Store a JSON object keyed by session\_id.  
last\_query: String.  
current\_filters: Object.  
visual\_theme: String (e.g., "cyberpunk", "minimalist").  
Directive: Use Redis Timeseries if the data is live-streaming sensor data.  
Phase 2: The "Brain" (Claude API Integration)  
Goal: Create a backend service that orchestrates the data and the AI.  
System Prompting: Define Claudeâ€™s role as a "Frontend Engineer Specializing in SVG."  
Tool Use: Provide Claude with a tool/function called fetch\_data(parameter\_set).  
Output Format: Force Claude to return a structured JSON response:  
json  
{  
  "explanation": "Brief text for TTS",  
  "svg\_code": "\<svg\>...\</svg\>",  
  "css\_styles": "@keyframes..."  
}  
Phase 3: The "Ear/Mouth" (Web Audio API)  
Input: Implement window.SpeechRecognition (or a Whisper API relay) to capture the prompt.  
Output: Feed the explanation field from Claude into window.speechSynthesis.  
Phase 4: The "Canvas" (Frontend Rendering)  
Component Sandbox: Create a React wrapper that uses dangerouslySetInnerHTML (safely sanitized) to inject the SVG and \<style\> tags generated by Claude.  
Animation Trigger: Use a useEffect hook to trigger the entry animations as soon as the SVG string is injected.

# Step-by-Step Directives for Developers

1. Initialize Environment: Setup a Next.js project with Tailwind CSS and a Redis (Upstash) connection.  
2. Build Prompt Wrapper: Create a function that pulls the last 3 interactions from Redis and appends them to the current user audio transcript.  
3. Construct "Designer" System Prompt:  
   **"You are a senior data visualization designer. You output only valid SVG and CSS. Use \<animate\> tags for motion. Ensure the SVG is responsive (width='100%')."**  
4. Implement API Route: /api/generate-ui takes audio text, Fetches Redis, Calls Claude, Updates Redis, Returns UI JSON.  
5. Build the Frontend Listener: Create a "Record" button that, upon release, sends audio to the API and waits for the SVG payload.

# Testing Rubrics & Criteria 

1\. Unit Testing (Logic)  
Test Case	Method	Success Criteria  
SVG Validation	Regex/DOM Parser	Generated string must be valid XML/SVG.  
Redis Persistence	Mock Redis Client	session\_id must correctly retrieve the previous "vibe."  
State Merging	Logic Test	New filters must merge with, not overwrite, baseline context.  
2\. Integration Testing (End-to-End)  
Test Case	Method	Success Criteria  
Audio-to-Visual Loop	Manual/Cypress	Audio input "Show Sales" renders an SVG within \< 3 seconds.  
Animation Presence	DOM Inspection	SVG must contain at least one \<animate\>, \<animateTransform\>, or @keyframes block.  
TTS Sync	Audio Event Listen	Speech begins within 500ms of the SVG appearing on screen.  
3\. UX/Performance Rubric  
Code Correctness: Does the SVG render without a console error? (Pass/Fail)  
Contextual Awareness: If the user says "Change it to blue," does the color change while keeping the data the same? (Score 1-5)  
Fluidity: Is the generated animation jitter-free on mobile devices? (Pass/Fail)

